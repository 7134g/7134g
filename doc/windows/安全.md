为防止漏洞被利用，需要采取必要措施，关闭以上端口，以保证系统更加安全。

window2003

关闭135端口的方法

要关闭此端口，只需停止DCOM接口服务即达到目的。下面是详细操作过程。

1、打开“组件服务”控制台

按 WIN+R 组合键打开运行对话框，输入“dcomcnfg”，单击“确定”，打开组件服务控制台。

2、点击“计算机”节点点击“组件服务”下面的“计算机”项目，如图：



3、打开“我的电脑”属性设置窗口

在“计算机”选项右边，右键单击“我的电脑”，选择“属性”。如图：



4、禁止“在此计算机上启用分布式COM”

在“我的电脑属性”对话框中，切换到“默认属性”标签，然后去掉“在此计算机上启用分布式COM”前的勾。如图：



5、删除“面向连接的TCP/IP”协议

切换到“默认协议”标签，选中“面向连接的TCP/IP”，然后点击“移除”按钮。最后不要忘了点击“确定”按钮。如图：





关闭137/138/139端口的方法

1、禁用Server服务

按 WIN+R 打开运行窗口，输入 services.msc ，按回车键，即可打开服务管理器。

找到 Server 名称，右键点击它，然后点击“属性”进入属性设置窗口。在属性窗口点击“停止”按钮，“启动类型”选择“禁用”，最后点击“确定”按钮。



2、禁用 TCP/IP 上的 NetBIOS

1）、设置“本地连接 状态”属性

打开“本地连接 状态”，然后点击“属性”

2）、设置 Internet 协议版本 4 (TCP/IPv4) 属性

选中“ Internet 协议版本 4 (TCP/IPv4) ”，然后点击“属性”；在弹出窗口里点击“高级”。

3）、选择“禁用TCP/IP上的NetBIOS”

在“高级 TCP/IP 设置”窗口里，切换到“WINS”标签，然后选择“禁用TCP/IP上的NetBIOS”。不要忘了点击“确定”按钮。





重启后生效，本地端口137/138/319 关闭。



利用组策略关闭端口

1、打开组策略编辑器按组合键WIN+R打开运行窗口，然后输入gpedit.msc，按回车键，即可进入组策略编辑器。

2、创建 IP 安全策略 展开选项“计算机配置”-“Windows 设置”-“安全设置”，然后点击“IP 安全策略，在本地计算机”，再在右边的空白处点击右键，再点“创建 IP 安全策略...”。



在弹出 IP 安全策略向导对话框里，单击下一步；在出现的对话框中的名称处写“关闭端口445”（可随意填写），点击下一步；对话框中的“激活默认响应规则”选项不要勾选，然后单击下一步；勾选“编辑属性”，单击完成。

3、添加 IP 安全规则

在属性窗口，不要勾选“使用 添加向导”，然后点击“添加”按钮。



4、添加新规则属性

在弹出的“新规则 属性”窗口里，直接点击“添加”按钮。



5、添加 IP 筛选器

在弹出的“IP 筛选器列表”窗口里，输入名称（可随意填写），不要勾选“使用添加向导”，然后点击“添加”按钮。



6、设置 IP 筛选器属性

在弹出的“设置 IP 筛选器属性”窗口里，在“地址”标签界面，源地址选择“任何 IP 地址”，目标地址选择“我的IP地址”。



在“协议”标签界面，选择协议类型为“TCP”（注意，135\139\445都是TCP端口，而137\138是UDP端口），设置 IP 协议端口为“从任意端口”和“到此端口”。“到此端口”是你要关闭的端口，是什么就填什么，如：445。最后点击“确定”按钮。



最后，配置策略阻止135/445端口。

 
